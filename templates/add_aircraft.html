// Format numeric fields on blur
function formatNumberInput(input) {
  let val = input.value.replace(/,/g, '');
  if (val && !isNaN(val)) {
    let parts = val.split('.');
    parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    input.value = parts.join('.');
  }
}
document.addEventListener('DOMContentLoaded', function() {
  const numericFields = [
    'id_mtow_kg', 'id_mtow_lbs', 'id_empty_weight_kg', 'id_empty_weight_lbs',
    'id_max_payload_kg', 'id_max_payload_lbs', 'id_zero_fuel_kg', 'id_zero_fuel_lbs',
    'id_fuel_capacity_gal', 'id_fuel_capacity_lbs', 'id_fuel_burn_gal', 'id_fuel_burn_lbs',
    'id_cruise_speed', 'id_acmi_cost',
    'id_cargo_positions_main_deck', 'id_cargo_positions_lower_deck'
  ];
  numericFields.forEach(function(id) {
    const el = document.getElementById(id);
    if (el) {
      el.addEventListener('blur', function() { formatNumberInput(el); });
    }
  });
});
{% load crispy_forms_tags %}
{% if form %}
<div class="tab-content-inner aircraft-form-page">
  <div class="aircraft-header">
    <h1 class="aircraft-title">Add New Aircraft</h1>
  </div>
  <div class="conversion-note">
    <div class="conversion-note-title">Auto-Conversion</div>
    <p>Enter values in either unit (kg/lbs or gal/lbs); the corresponding field will be calculated automatically.</p>
  </div>
  <div class="aircraft-form-container">
    <form method="post" action="/add-aircraft/">
      {% csrf_token %}
      <!-- Render Django form fields with custom layout -->
      <div class="aircraft-form-section">
        <div class="aircraft-section-title">Basic Information</div>
        <div class="aircraft-form-row three-col">
          {{ form.aircraft_id|as_crispy_field }}
          {{ form.manufacturer|as_crispy_field }}
          {{ form.model|as_crispy_field }}
          {{ form.short_name|as_crispy_field }}
        </div>
      </div>
      <hr class="aircraft-section-separator" />
      <div class="aircraft-form-section">
        <div class="aircraft-section-title">Weight & Fuel Information</div>
        <div class="aircraft-form-row three-col">
          {{ form.mtow_kg|as_crispy_field }}
          {{ form.mtow_lbs|as_crispy_field }}
          {{ form.empty_weight_kg|as_crispy_field }}
          {{ form.empty_weight_lbs|as_crispy_field }}
          {{ form.max_payload_kg|as_crispy_field }}
          {{ form.max_payload_lbs|as_crispy_field }}
          {{ form.zero_fuel_kg|as_crispy_field }}
          {{ form.zero_fuel_lbs|as_crispy_field }}
          {{ form.fuel_capacity_gal|as_crispy_field }}
          {{ form.fuel_capacity_lbs|as_crispy_field }}
          {{ form.fuel_burn_gal|as_crispy_field }}
          {{ form.fuel_burn_lbs|as_crispy_field }}
        </div>
      </div>
      <hr class="aircraft-section-separator" />
      <div class="aircraft-form-section">
        <div class="aircraft-section-title">Operations &amp; Cost Information</div>
        <div class="aircraft-form-row three-col">
          {{ form.cargo_positions_main_deck|as_crispy_field }}
          {{ form.cargo_positions_lower_deck|as_crispy_field }}
          {{ form.cruise_speed|as_crispy_field }}
          {{ form.acmi_cost|as_crispy_field }}
        </div>
      </div>
      <button type="submit" class="aircraft-btn">Add Aircraft</button>
    </form>
  </div>
</div>
{% endif %}